function RndText(){var e=Math.floor(Math.random()*randomTextArray.length);$(".tryRandom").fadeOut("slow",function(){$(this).text(randomTextArray[e]).fadeIn("slow")})}function newSearch(e){d3.json("js/search_terms.json",function(s){var a=e[0],t=e[1],n=e[2],i=e[3];if(1===e.length){var o=new Fuse(s,options),r=o.search(a);searchResults=r,drawDranks(r)}else if(2===e.length){var o=new Fuse(s,options),r=o.search(a),l=new Fuse(r,options),d=l.search(t);searchResults=d,drawDranks(d)}else if(3===e.length){var o=new Fuse(s,options),r=o.search(a),l=new Fuse(r,options),d=l.search(t),c=new Fuse(d,options),v=c.search(t);searchResults=v,drawDranks(v)}else if(4===e.length){var o=new Fuse(s,options),r=o.search(a),l=new Fuse(r,options),d=l.search(t),c=new Fuse(d,options),v=c.search(t),u=new Fuse(v,options),h=u.search(i);searchResults=h,drawDranks(h)}})}function drawDranks(e){$(".under").css("opacity",0),$(".try").css("opacity",0),$(".logo").css("opacity",0),$(".fullWrapper").addClass("fullWrapper-top"),$(".fullInner").addClass("fullInner-top"),$(".selectize-input").addClass("selectize-input-top"),$("#input-tags-selectized").css("height","50px").css("font-size","18px").css("color","white"),d3.selectAll(".dRemove").remove();for(var s=0;s<e.length;s++){var a=e[s],t=a.colour,n=a.name,i=a.type,o=a.sub,r=a.left,l=a.code,d=d3.select("#row1").append("div").attr("class","dRemove box col-md-3 col-sm-4 col-xs-12").attr("id","drank-"+s).html('<div class="dRemove box_inner" id="box_inner-'+s+'"></div>');$(".box").css("height",$(".box").width()+"px");var c=d3.select("#box_inner-"+s);c.style("background-color","none").transition().duration(500).style("background-color",t);var v=hexToRgb(t);Math.round((299*parseInt(v.r)+587*parseInt(v.g)+114*parseInt(v.b))/1e3)>200?c.style("color","#333"):c.style("color","white"),c.on("click",function(e){drinkClick(this)}),c.append("div").attr("class","dName").html(n),c.append("div").attr("class","dSub").html(o.substring(0,50)),c.append("div").attr("class","dLeft").html(r+"%"),c.append("div").attr("class","dRight").html(i),c.append("div").attr("class","dGlass").attr("id","dGlass-"+s),$("#dGlass-"+s).html(l.replace(/(\r\n|\n|\r)/gm,"")),d3.select("#row1").transition().delay(2e3).duration(1e3).style("opacity",1)}}function drinkClick(e){var s=$(e).attr("id");s=s.substring(10,s.length);var a=searchResults[s];d3.select("#drank-"+s).append("div").attr("class","drinkOverlay").html("<div class='drinkOverlay-inner' id='drinkOverlay"+s+"'></div>");var t=d3.select("#drinkOverlay"+s).style("display","flex").style("align-items","center").append("div").style("width","100%").style("text-align","center").style("color","white").style("padding","15px"),n=a.drink.replace("s",""),i=a.category,o=a.type,r=a.glassware,l=a.info1,d=a.info2,c=a.info3,v=a.info4,u=a.name,h=a.colour;"beers"===a.drink?t.html("<div class='oL1 oLt'>Drink</div><div class='oL15 oLm'>"+n+"</div><div class='oL2 oLt'>Category</div><div class='oL25 oLm'>"+i+"</div><div class='oL3 oLt'>Colour</div><div class='oL35 oLm'>"+l+"</div><div class='oL4 oLt'>Clarity</div><div class='oL45 oLm'>"+c+"</div><div class='oL5 oLt'>Served in:</div><div class='oL55 oLm'>a "+r+" glass</div>"):"wines"===a.drink?t.html("<div class='oL1 oLt'>Drink</div><div class='oL15 oLm'>"+n+"</div><div class='oL2 oLt'>Category</div><div class='oL25 oLm'>"+i+"</div><div class='oL4 oLt'>Origins</div><div class='oL45 oLm'>"+l+"</div>"):t.html("<div class='oL1 oLt'>Drink</div><div class='oL15 oLm'>"+n+"</div><div class='oL2 oLt'>Category</div><div class='oL25 oLm'>"+o+"</div><div class='oL4 oLt'>Ingredients</div><div class='oL45 oLm'>"+l+"</div><div class='oL5 oLt'>Served in:</div><div class='oL55 oLm'>a "+r+" glass</div>"),t.append("div").attr("class","exit").html('<i class="fa fa-times" aria-hidden="true"></i>').on("click",function(e){d3.selectAll("#drinkOverlay"+s).remove()}),t.on("click",function(e){d3.selectAll("#drinkOverlay"+s).remove()})}function getRGB(e){var s=e.match(/rgba?\((\d{1,3}), ?(\d{1,3}), ?(\d{1,3})\)?(?:, ?(\d(?:\.\d?))\))?/);return s?{red:s[1],green:s[2],blue:s[3]}:{}}function hexToRgb(e){var s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return s?{r:parseInt(s[1],16),g:parseInt(s[2],16),b:parseInt(s[3],16)}:null}var randomTextArray=["beer...","ale...","lager...","amber ale...","pale ale...","stout...","wine...","red wine...","white wine...","medium red...","zinfandel...","pinot...","orange...","dry...","rose...","citrusy light white...","old fashioned...","orange...","whisky...","vodka...","gin...","rum...","tequila...","tomato...","apple...","cider..."];$(function(){RndText()});var inter=setInterval(function(){RndText()},3e3),haystack=[],newHaystack=[];d3.json("js/search_terms.json",function(e){for(var s=0;s<e.length;s++)t=e[s],haystack.push(t.name),haystack.push(t.drink),haystack.push(t.category),haystack.push(t.type)}),$.getJSON("js/haystack.json",function(e){newHaystack=e}),jQuery(document).ready(function($){}),$(function(){$("#searchHome").suggest(haystack,{suggestionColor:"#cccccc",moreIndicatorClass:"suggest-more",moreIndicatorText:""}),$("#searchHome").keyup(function(){$(".under").html("Hit enter to search").fadeIn("slow")})}),setTimeout(function(){var e=$(".input-tags").selectize({plugins:["remove_button"],maxItems:4,valueField:"name",labelField:"name",searchField:["name"],options:newHaystack,openOnFocus:!1,render:{item:function(e,s){return"<div>"+(e.name?'<span class="name">'+s(e.name)+"</span>":"")+"</div>"}}}),s=e[0].selectize;$(".input-tags").focusin(function(){s.close()}),$(".input-tags").on("change",function(e){s.close(),values=s.getValue(),values=values.split(","),newSearch(values)})},150);var searchResults=[],searchTerm="",options={shouldSort:!0,threshold:.6,location:0,distance:100,maxPatternLength:32,minMatchCharLength:1,keys:["drink","type","name","category","sub","left"]};$(".infoCredits").on("click",function(e){$(".infoOverlay").css("display","block")}),$(".infoOverlay").on("click",function(e){$(".infoOverlay").css("display","none")}),$(".exit2").on("click",function(e){$(".infoOverlay").css("display","none")});